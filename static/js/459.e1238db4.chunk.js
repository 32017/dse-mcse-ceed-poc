"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[459],{41459:function(e,r,n){n.r(r);var c=n(29439),o=n(72791),a=n(78983),t=n(34045),i=n(80184);r.default=function(){var e={header:[],body:[]},r=o.useState(e),n=(0,c.Z)(r,2),s=n[0],l=n[1],d=o.useRef(),u=function(e){if(e){var r=new FileReader,n=!!r.readAsBinaryString;r.onload=function(e){try{var r=e.target.result,c=t.ij(r,{type:n?"binary":"array"}),o=c.SheetNames[0],a=c.Sheets[o];console.log(n,c);var i=t.P6.sheet_to_json(a,{header:1});console.log(i),h(i),console.log(s)}catch(l){console.error(l)}},n?r.readAsBinaryString(e):r.readAsArrayBuffer(e)}else console.error("file is empty")},h=function(e){if(Array.isArray(e)){var r=e[0],n=e.splice(1);l({header:r,body:n})}},f=function(e){return(0,i.jsx)(i.Fragment,{children:e.map((function(e,r){return(0,i.jsx)(a.NN,{children:e||""},"".concat(e,"_").concat(r))}))})};return(0,i.jsx)("div",{className:"px-3",children:(0,i.jsxs)(a.KB,{children:[(0,i.jsx)(a.rb,{children:(0,i.jsx)(a.b7,{md:4,children:(0,i.jsxs)(a.YR,{className:"mb-3",children:[(0,i.jsx)(a.jO,{type:"file",accept:".xlsx",id:"inputFile",onChange:function(e){var r=e.target.files;console.log(r),u(r[0])},ref:d}),(0,i.jsx)(a.u5,{type:"button",color:"secondary",variant:"outline",children:"\u958b\u59cb\u4e0a\u50b3"}),(0,i.jsx)(a.u5,{type:"button",color:"secondary",variant:"outline",onClick:function(){d.current.value=null,l(e)},children:"\u79fb\u9664"})]})})}),(0,i.jsx)("div",{children:(0,i.jsx)(a.rb,{className:"form-box px-2 overflow-scroll",children:(0,i.jsxs)(a.Sx,{hover:!0,className:"table-bg-none",children:[(0,i.jsx)(a.V,{children:(0,i.jsx)(a.T6,{children:s.header.map((function(e,r){return(0,i.jsx)(a.is,{scope:"col",children:e},"".concat(e,"_").concat(r))}))})}),(0,i.jsx)(a.NR,{children:s.body.map((function(e,r){return(0,i.jsx)(a.T6,{children:f(e)},"body_".concat(r))}))})]})})})]})})}}}]);
//# sourceMappingURL=459.e1238db4.chunk.js.map