(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[77],{1327:function(e,r,t){"use strict";t.d(r,{TF:function(){return v},ov:function(){return b},HG:function(){return f},P0:function(){return x},AU:function(){return y},A4:function(){return m},_q:function(){return D},Xp:function(){return Z},TR:function(){return N},qo:function(){return j},Cs:function(){return g},bI:function(){return h}});var n=t(1413),a=t(74165),s=t(15861),i=t(31243).Z.create({baseURL:"https://ebu-lsp-api-dev.azurewebsites.net",timeout:6e4});i.interceptors.request.use((function(e){return console.log("Starting Request",JSON.stringify(e,null,2)),e})),i.interceptors.response.use((function(e){return 200===e.status?e.data:Promise.reject(e)}),(function(e){return Promise.reject(e)}));var o,l=i,u=t(32808),c=t.n(u),d=t(40757),p=function(e){return e+"?"+c().stringify({code:"G0JQzK7qoEKnPD8v1esiGhpVUigfOVqUggRfd6wCDXYrAzFu41ZG-w=="})},f=function(e){var r={body:{orderId:e}},t=p("api/getOrderById");return l.post(t,r.body)},m=function(e){var r={body:{status:e}},t=p("api/getOrdersByStatus");return l.post(t,r.body)},v=function(e,r){var t={body:{action:e,orderId:r}},n=p("api/approveOrder");return l.post(n,t.body)},y=function(e){var r={body:{taxID:e.taxID,orderId:e.orderId,startDate:e.startDate,endDate:e.endDate}},t=p("api/getOrders");return l.post(t,r.body)},x=function(e){var r={body:{company:e.company,createdDate:e.createdDate}},t=p("api/getOrderReports");return l.post(t,r.body)},b=function(e,r){return(o=o||(0,s.Z)((0,a.Z)().mark((function e(r,t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.get("https://ebudatadev.blob.core.windows.net/lspoutput/".concat(r,"-").concat(t,".json.gz"),{responseType:"arraybuffer"});case 2:return n=e.sent,e.abrupt("return",(0,d.xe)(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)},h=function(e){var r={body:e,headers:{headers:{"Content-Type":"multipart/form-data"}}},t=p("api/uploadProductFile");return l.post(t,r.body,r.headers)},j=function(e){var r={body:{userName:e.userName,description:e.description,importFiles:e.importFiles}},t=p("api/saveProductVersion");return l.post(t,r.body,r.headers)},N=function(e){var r={body:(0,n.Z)({},e)},t=p("api/saveOrder");return l.post(t,r.body)},g=function(e){var r={body:(0,n.Z)({},e)},t=p("api/updateOrder");return l.post(t,r.body)},Z=function(e){var r={body:(0,n.Z)({},e)},t=p("api/getProducts");return l.post(t,r.body)},D=function(){var e=p("api/getProductVersions");return l.post(e)}},14927:function(e,r,t){"use strict";var n=t(74165),a=t(15861),s=t(29439),i=t(72791);r.Z=function(e){var r,t=(0,i.useState)(null),o=(0,s.Z)(t,2),l=o[0],u=o[1],c=(0,i.useState)(""),d=(0,s.Z)(c,2),p=d[0],f=d[1],m=(0,i.useState)(!1),v=(0,s.Z)(m,2),y=v[0],x=v[1];return{data:l,error:p,loading:y,request:function(){return(r=r||(0,a.Z)((0,n.Z)().mark((function r(){var t,a,s,i,o,l=arguments;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(x(!0),f(""),t=l.length,a=new Array(t),s=0;s<t;s++)a[s]=l[s];return r.prev=3,r.next=6,e.apply(void 0,a);case 6:return i=r.sent,console.log("response: ",JSON.stringify(i)),console.log("apiFuntions: ",null===e||void 0===e?void 0:e.name),u(i),r.abrupt("return",i);case 13:r.prev=13,r.t0=r.catch(3),o="ReactNativeError: args: ".concat(a," ").concat(r.t0.message," "),console.error(o),f(r.t0.message||"API request Unexpected Error!");case 18:return r.prev=18,x(!1),r.finish(18);case 21:case"end":return r.stop()}}),r,null,[[3,13,18,21]])})))).apply(this,arguments)},resetError:function(){f("")},resetData:function(){u(null)}}}},42031:function(e,r,t){"use strict";t.d(r,{A:function(){return n},x:function(){return a}});var n=[{id:"additional_product",displayName:"Additional Product"},{id:"enterprise",displayName:"Enterprise"},{id:"faculty",displayName:"Faculty"},{id:"mvlp",displayName:"MVLP"},{id:"server_and_cloud_enrollment",displayName:"Server and Cloud Enrollment"},{id:"student",displayName:"Student"},{id:"mpsa",displayName:"MPSA"}],a=[{id:"A",displayName:"A"},{id:"B",displayName:"B"},{id:"C",displayName:"C"},{id:"D",displayName:"D"},{id:"NON SPECIFIC",displayName:"NON SPECIFIC"}]},70027:function(e,r,t){"use strict";var n=t(29439),a=t(72791),s=t(78983),i=t(80184);r.Z=function(e){var r=(0,a.useState)(!1),t=(0,n.Z)(r,2),o=t[0],l=t[1];return(0,a.useEffect)((function(){l(e.isShow)}),[e.isShow]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.Tk,{alignment:"center",visible:o,onClose:e.closeModal,children:[(0,i.jsx)(s.p0,{children:(0,i.jsx)(s.fl,{children:e.title||""})}),(0,i.jsx)(s.sD,{children:e.infoContain}),(0,i.jsx)(s.Ym,{children:(0,i.jsx)(s.u5,{color:"primary",onClick:e.closeModal,children:"\u6211\u77e5\u9053\u4e86"})})]})})}},67516:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return y}});var n=t(1413),a=t(29439),s=t(72791),i=t(78983),o=t(24846),l=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M426.072,86.928A238.75,238.75,0,0,0,88.428,424.572,238.75,238.75,0,0,0,426.072,86.928ZM257.25,462.5c-114,0-206.75-92.748-206.75-206.75S143.248,49,257.25,49,464,141.748,464,255.75,371.252,462.5,257.25,462.5Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='221.27 305.808 147.857 232.396 125.23 255.023 221.27 351.063 388.77 183.564 366.142 160.937 221.27 305.808' class='ci-primary'/>"],u=t(42031),c=t(1327),d=t(14927),p=t(70027),f=t(80184),m={faculty:{fileName:"",load:!1,excelData:null},mvlp:{fileName:"",load:!1,excelData:null},mpsa:{fileName:"",load:!1,excelData:null},server_and_cloud_enrollment:{fileName:"",load:!1,excelData:null},student:{fileName:"",load:!1,excelData:null},additional_product:{fileName:"",load:!1,excelData:null},enterprise:{fileName:"",load:!1,excelData:null}},v={faculty:0,mvlp:0,mpsa:0,server_and_cloud_enrollment:0,student:0,additional_product:0,enterprise:0},y=function(){var e=(0,d.Z)(c.qo),r=e.request,t=e.data,y=e.loading,x=e.error,b=(0,d.Z)(c.bI),h=(0,d.Z)(c._q),j=(0,s.useState)({currentVersion:"",latestVersion:""}),N=(0,a.Z)(j,2),g=N[0],Z=N[1],D=s.useRef([]),_=(0,s.useState)(m),S=(0,a.Z)(_,2),C=S[0],O=S[1],V=(0,s.useState)(v),w=(0,a.Z)(V,2),A=w[0],F=w[1],I=(0,s.useState)(!1),P=(0,a.Z)(I,2),q=P[0],k=P[1],E=(0,s.useState)(!1),R=(0,a.Z)(E,2),M=R[0],z=R[1],G=(0,s.useState)([]),B=(0,a.Z)(G,2),T=B[0],U=B[1],L=u.A;D.current.length!==L.length&&(D.current=Array(L).map((function(e,r){return D.current[e]||s.createRef()}))),(0,s.useEffect)((function(){h.request()}),[]);var J=function(e,r){D.current[r].value=null,C[e].excelData=null,O((0,n.Z)({},C))},K=function(e,r){e?(C[r].load=!0,O((0,n.Z)({},C))):console.error("file is empty")},Y=function(e){!function(){for(var e=0,r=Object.entries(C);e<r.length;e++){var t=(0,a.Z)(r[e],2),n=t[0],s={fileName:t[1].fileName,category:n};T.push(s)}U(T)}(),Array(e).map((function(e,r){return D.current[r].value=null})),r({userName:"admin",description:"",importFiles:T})};(0,s.useEffect)((function(){var e,r,n,a,s,i,o,l,u,c,d,p,f;((t||x)&&(U([]),O(m),F(v),k(!1)),x&&z(!0),200===(null===(e=h.data)||void 0===e?void 0:e.status))&&Z({currentVersion:{num:null===(r=h.data)||void 0===r||null===(n=r.data)||void 0===n||null===(a=n.currentVersionData)||void 0===a?void 0:a.versionNumber,status:null===(s=h.data)||void 0===s||null===(i=s.data)||void 0===i||null===(o=i.currentVersionData)||void 0===o?void 0:o.statusDisplay},latestVersion:{num:null===(l=h.data)||void 0===l||null===(u=l.data)||void 0===u||null===(c=u.latestVersionData)||void 0===c?void 0:c.versionNumber,status:null===(d=h.data)||void 0===d||null===(p=d.data)||void 0===p||null===(f=p.latestVersionData)||void 0===f?void 0:f.statusDisplay}});h.error&&Z({currentVersion:"\u7cfb\u7d71\u5fd9\u788c\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66",latestVersion:"\u7cfb\u7d71\u5fd9\u788c\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66"})}),[t,x,h.data,h.error]);var Q=function(e){var r=e.show;return r?(0,f.jsx)(i.b7,{md:2,className:"d-flex align-items-end mb-4",children:(0,f.jsx)(o.Z,{className:1===r?"text-secondary":"text-success",icon:l,size:"lg"})}):null},X=function(e){var r=e.categoryOptions,t=e.num,a=r.displayName,s=r.id;return(0,f.jsxs)(i.rb,{children:[(0,f.jsx)(i.b7,{md:3,children:(0,f.jsx)(i.jO,{type:"text",value:a,readOnly:!0,disabled:!0})}),(0,f.jsx)(i.b7,{md:6,children:(0,f.jsxs)(i.YR,{className:"mb-4",children:[(0,f.jsxs)("label",{className:"inputFile",children:[(0,f.jsx)("div",{children:"\u8acb\u9078\u64c7\u6a94\u6848"}),(0,f.jsx)(i.jO,{accept:".xlsx",id:s,type:"file",onChange:function(e){!function(e,r){var t=e.target.files;C[r].fileName=t[0].name,C[r].excelData=t[0],O((0,n.Z)({},C)),K(t[0],r)}(e,s)},ref:function(e){return D.current[t]=e},style:{display:"none"}})]}),(0,f.jsx)(i.jO,{readOnly:!0,disabled:!0,type:"text",value:C[s].fileName||"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",ref:function(e){return D.current[t]=e},style:{backgroundColor:"transparent"}}),(0,f.jsx)(i.u5,{type:"button",color:C[s].load?"primary":"secondary",variant:"outline",disabled:!C[s].load,onClick:function(){return function(e,r){var t;if(A[e]=1,F((0,n.Z)({},A)),null!==(t=C[e])&&void 0!==t&&t.excelData){var a=new FormData;a.append("file",C[e].excelData),b.request(a.getAll("file")).then((function(r){if(200===r.status){A[e]=2,F((0,n.Z)({},A));var t=Object.keys(A).every((function(e){return 2===A[e]}));t&&k(!0)}})).catch((function(t){A[e]=0,J(e,r),console.log(t)}))}}(s,t)},children:"\u958b\u59cb\u4e0a\u50b3"})]})}),(0,f.jsx)(Q,{show:A[s]})]})};return(0,f.jsxs)("div",{className:"px-3",children:[(0,f.jsxs)(i.KB,{children:[200===(null===t||void 0===t?void 0:t.status)&&(0,f.jsx)(i.Gc,{color:"success",dismissible:!0,children:"\u4e0a\u50b3\u6210\u529f"}),!q&&(0,f.jsxs)(i.Gc,{color:"info",dismissible:!0,children:[(0,f.jsx)(i.g$,{component:"h4",children:"MS\u6a9f\u683c\u518a\u6574\u6279\u532f\u5165"}),(0,f.jsx)("p",{className:"m-0",children:"1. \u9700\u4e0a\u50b3\u5168\u90e8\u7684\u50f9\u683c\u518a\u624d\u80fd\u6574\u6279\u532f\u5165"}),(0,f.jsx)("p",{className:"m-0",children:"2. \u50f9\u683c\u518a\u6a94\u540d\u4e0d\u53ef\u6709\u4e2d\u6587"})]}),(0,f.jsx)("h5",{className:"mb-3",children:"\u50f9\u683c\u518a\u8cc7\u8a0a"}),(0,f.jsxs)("div",{className:"form-box",children:[(0,f.jsxs)(i.rb,{className:"align-items-center pb-2",children:[(0,f.jsxs)(i.b7,{sm:4,children:["\u7576\u524d\u50f9\u683c\u518a\u7248\u865f(",g.currentVersion.status,")"]}),(0,f.jsx)(i.b7,{sm:2,children:g.currentVersion.num})]}),(0,f.jsxs)(i.rb,{className:"align-items-center",children:[(0,f.jsxs)(i.b7,{sm:4,children:["\u6700\u65b0\u50f9\u683c\u518a\u7248\u672c(",g.latestVersion.status,")"]}),(0,f.jsx)(i.b7,{sm:2,children:g.latestVersion.num})]})]}),(0,f.jsx)("h5",{className:"mb-3",children:"\u4e0a\u50b3\u50f9\u683c\u518a"}),(0,f.jsx)("div",{className:"form-box mb-1 pt-4 pb-0",style:{borderRadius:"10px 10px 0 0"},children:u.A.map((function(e,r){return(0,f.jsx)(X,{categoryOptions:e,num:r},r)}))}),(0,f.jsx)("div",{className:"form-box",style:{borderRadius:"0 0 10px 10px"},children:(0,f.jsx)(i.rb,{md:{cols:12},children:(0,f.jsx)(i.b7,{md:12,children:(0,f.jsx)(i.u5,{onClick:function(){return Y(u.A)},disabled:!q||y,color:q?"primary":"secondary",type:"button",variant:"outline",children:y?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(i.LQ,{component:"span",size:"sm","aria-hidden":"true"}),(0,f.jsx)("span",{children:" Loading..."})]}):"\u9001\u51fa\u50f9\u683c\u518a"})})})})]}),(0,f.jsx)(p.Z,{isShow:M,closeModal:function(){return z(!1)},title:"\u7cfb\u7d71\u932f\u8aa4",infoContain:"\u7cfb\u7d71\u5fd9\u788c\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66"})]})}},24654:function(){}}]);
//# sourceMappingURL=77.d139e732.chunk.js.map