(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[861],{1327:function(e,t,n){"use strict";n.d(t,{uC:function(){return _},TF:function(){return x},ov:function(){return y},HG:function(){return p},P0:function(){return h},AU:function(){return v},A4:function(){return m},_q:function(){return D},Xp:function(){return Z},TR:function(){return j},qo:function(){return N},qG:function(){return S},DH:function(){return C},Cs:function(){return g},bI:function(){return b}});var r=n(1413),a=n(74165),s=n(15861),i=n(31243).Z.create({baseURL:"https://ebu-lsp-api-dev.azurewebsites.net",timeout:6e4});i.interceptors.request.use((function(e){return console.log("Starting Request",JSON.stringify(e,null,2)),e})),i.interceptors.response.use((function(e){return 200===e.status?e.data:Promise.reject(e)}),(function(e){return Promise.reject(e)}));var o,u=i,l=n(32808),c=n.n(l),d=n(40757),f=function(e){return e+"?"+c().stringify({code:"G0JQzK7qoEKnPD8v1esiGhpVUigfOVqUggRfd6wCDXYrAzFu41ZG-w=="})},p=function(e){var t={body:{orderId:e}},n=f("api/getOrderById");return u.post(n,t.body)},m=function(e){var t={body:{statuses:e}},n=f("api/getOrdersByStatus");return u.post(n,t.body)},x=function(e,t){var n={body:{action:e,orderId:t}},r=f("api/approveOrder");return u.post(r,n.body)},v=function(e){var t={body:{taxID:e.taxID,orderId:e.orderId,startDate:e.startDate,endDate:e.endDate}},n=f("api/getOrders");return u.post(n,t.body)},h=function(e){var t={body:{company:e.company,createdDate:e.createdDate}},n=f("api/getOrderReports");return u.post(n,t.body)},y=function(e,t){return(o=o||(0,s.Z)((0,a.Z)().mark((function e(t,n){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.get("https://ebudatadev.blob.core.windows.net/lspoutput/".concat(t,"-").concat(n,".json.gz"),{responseType:"arraybuffer"});case 2:return r=e.sent,e.abrupt("return",(0,d.xe)(r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)},b=function(e){var t={body:e,headers:{headers:{"Content-Type":"multipart/form-data"}}},n=f("api/uploadProductFile");return u.post(n,t.body,t.headers)},N=function(e){var t={body:{userName:e.userName,description:e.description,importFiles:e.importFiles}},n=f("api/saveProductVersion");return u.post(n,t.body,t.headers)},j=function(e){var t={body:(0,r.Z)({},e)},n=f("api/saveOrder");return u.post(n,t.body)},g=function(e){var t={body:(0,r.Z)({},e)},n=f("api/updateOrder");return u.post(n,t.body)},Z=function(e){var t={body:(0,r.Z)({},e)},n=f("api/getProducts");return u.post(n,t.body)},D=function(){var e=f("api/getProductVersions");return u.post(e)},_=function(){var e=f("api/adfPipelineTrigger");return u.post(e)},S=function(e){var t={body:{userName:e.userName,importFiles:e.importFiles}},n=f("api/updateLatestVersionData");return u.post(n,t.body,t.headers)},C=function(e){var t={body:{status:"IN_PROGRESS"}},n=f("api/updateLatestVersionData");return u.post(n,t.body,t.headers)}},14927:function(e,t,n){"use strict";var r=n(74165),a=n(15861),s=n(29439),i=n(72791);t.Z=function(e){var t,n=(0,i.useState)(null),o=(0,s.Z)(n,2),u=o[0],l=o[1],c=(0,i.useState)(""),d=(0,s.Z)(c,2),f=d[0],p=d[1],m=(0,i.useState)(!1),x=(0,s.Z)(m,2),v=x[0],h=x[1];return{data:u,error:f,loading:v,request:function(){return(t=t||(0,a.Z)((0,r.Z)().mark((function t(){var n,a,s,i,o,u=arguments;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(h(!0),p(""),n=u.length,a=new Array(n),s=0;s<n;s++)a[s]=u[s];return t.prev=3,t.next=6,e.apply(void 0,a);case 6:return i=t.sent,console.log("response: ",JSON.stringify(i)),console.log("apiFuntions: ",null===e||void 0===e?void 0:e.name),l(i),t.abrupt("return",i);case 13:t.prev=13,t.t0=t.catch(3),o="ReactNativeError: args: ".concat(a," ").concat(t.t0.message," "),console.error(o),p(t.t0.message||"API request Unexpected Error!");case 18:return t.prev=18,h(!1),t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[3,13,18,21]])})))).apply(this,arguments)},resetError:function(){p("")},resetData:function(){l(null)}}}},42031:function(e,t,n){"use strict";n.d(t,{A:function(){return r},x:function(){return a}});var r=[{id:"additional_product",displayName:"Additional Product"},{id:"enterprise",displayName:"Enterprise"},{id:"faculty",displayName:"Faculty"},{id:"mvlp",displayName:"MVLP"},{id:"server_and_cloud_enrollment",displayName:"Server and Cloud Enrollment"},{id:"student",displayName:"Student"},{id:"mpsa",displayName:"MPSA"}],a=[{id:"A",displayName:"A"},{id:"B",displayName:"B"},{id:"C",displayName:"C"},{id:"D",displayName:"D"},{id:"NON SPECIFIC",displayName:"NON SPECIFIC"}]},70027:function(e,t,n){"use strict";var r=n(29439),a=n(72791),s=n(78983),i=n(80184);t.Z=function(e){var t=(0,a.useState)(!1),n=(0,r.Z)(t,2),o=n[0],u=n[1];return(0,a.useEffect)((function(){u(e.isShow)}),[e.isShow]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.Tk,{alignment:"center",visible:o,onClose:e.closeModal,children:[(0,i.jsx)(s.p0,{children:(0,i.jsx)(s.fl,{children:e.title||""})}),(0,i.jsx)(s.sD,{children:e.infoContain}),(0,i.jsxs)(s.Ym,{children:[e.leftBtnText&&(0,i.jsx)(s.u5,{color:"secondary",onClick:e.handleLeftBtn,children:e.leftBtnText}),e.rightBtnText&&(0,i.jsx)(s.u5,{color:"primary",onClick:e.handleRightBtn,children:e.rightBtnText})]})]})})}},71368:function(e,t,n){"use strict";var r=n(29439),a=n(72791),s=n(78983),i=n(80184);t.Z=function(e){var t=(0,a.useState)(!1),n=(0,r.Z)(t,2),o=n[0],u=n[1];return(0,a.useEffect)((function(){u(e.isShow)}),[e.isShow]),o?(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)(s.LQ,{className:"m-5"})}):null}},43752:function(e,t,n){"use strict";var r=n(1413),a=n(29439),s=n(72791),i=n(1327),o=n(14927),u=n(71368),l=n(80184);t.Z=function(e){return function(t){var n=(0,s.useState)(null),c=(0,a.Z)(n,2),d=c[0],f=c[1],p=(0,s.useState)(!1),m=(0,a.Z)(p,2),x=m[0],v=m[1],h=(0,o.Z)(i._q),y=h.request,b=h.data,N=h.error,j=h.loading;(0,s.useEffect)((function(){y()}),[x]);(0,s.useEffect)((function(){g()}),[N,b]);var g=function(){N&&console.error("execute getProductVersions() error",N),b&&(200===b.status?f(b.data):console.log("execute getProductVersions() data error",null===b||void 0===b?void 0:b.status))};return j?(0,l.jsx)(u.Z,{isShow:!0}):(0,l.jsx)(e,(0,r.Z)((0,r.Z)({},t),{},{version:d,callbackFunc:function(){v(!x)}}))}}},26314:function(e,t,n){"use strict";n.r(t);var r=n(74165),a=n(15861),s=n(1413),i=n(29439),o=n(72791),u=n(78983),l=n(24846),c=n(79041),d=n(42031),f=n(1327),p=n(14927),m=n(70027),x=n(43752),v=n(80184),h={infoContain:"\u4e0a\u50b3\u6210\u529f",title:""},y={infoContain:"\u7cfb\u7d71\u5fd9\u788c\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66",title:"\u7cfb\u7d71\u932f\u8aa4"},b={faculty:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},mvlp:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},mpsa:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},server_and_cloud_enrollment:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},student:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},additional_product:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},enterprise:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null}},N={faculty:0,mvlp:0,mpsa:0,server_and_cloud_enrollment:0,student:0,additional_product:0,enterprise:0};t.default=(0,x.Z)((function(e){var t,n,x,j,g=(0,p.Z)(f.qo),Z=g.request,D=g.data,_=g.loading,S=g.error,C=(0,p.Z)(f.bI),w=(0,p.Z)(f.uC),O=(0,o.useState)({}),P=(0,i.Z)(O,2),F=P[0],A=P[1],E=o.useRef([]),k=(0,o.useState)(b),I=(0,i.Z)(k,2),V=I[0],q=I[1],R=(0,o.useState)(N),B=(0,i.Z)(R,2),T=B[0],L=B[1],G=(0,o.useState)(!1),M=(0,i.Z)(G,2),z=M[0],U=M[1],J=(0,o.useState)(!1),K=(0,i.Z)(J,2),Q=K[0],Y=K[1],H=(0,o.useState)([]),X=(0,i.Z)(H,2),$=X[0],W=X[1],ee=(0,o.useState)({infoContain:"",title:""}),te=(0,i.Z)(ee,2),ne=te[0],re=te[1],ae=(0,o.useState)(!0),se=(0,i.Z)(ae,2),ie=se[0],oe=se[1],ue=d.A;E.current.length!==ue.length&&(E.current=Array(ue).map((function(e,t){return E.current[e]||o.createRef()}))),(0,o.useEffect)((function(){pe(),e.version&&(A(e.version),oe("inProgress"===e.version.latestVersionData.status))}),[e.version]),(0,o.useEffect)((function(){console.log("isUpload",T)}),[T]),(0,o.useEffect)((function(){console.log("fileInfo",V)}),[V]);var le=function(e,t){E.current[t].value=null,V[e].excelData=null,q((0,s.Z)({},V))},ce=function(e,t){e?(V[t].load=!0,q((0,s.Z)({},V))):console.error("file is empty")},de=function(){for(var e=0,t=Object.entries(V);e<t.length;e++){var n=(0,i.Z)(t[e],2),r=n[0],a={fileName:n[1].fileName,category:r};$.push(a)}W($)},fe=function(e){return(t=t||(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z({userName:"admin",description:"",importFiles:$});case 2:return e.next=4,w.request();case 4:Array(t).map((function(e,t){return E.current[t].value=null}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)},pe=function(){W([]),U(!1),L({faculty:0,mvlp:0,mpsa:0,server_and_cloud_enrollment:0,student:0,additional_product:0,enterprise:0}),q({faculty:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},mvlp:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},mpsa:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},server_and_cloud_enrollment:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},student:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},additional_product:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null},enterprise:{fileName:"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",load:!1,excelData:null}})};(0,o.useEffect)((function(){var e;(S||D&&200!==D.status||w.error||w.data&&200!==w.data.status)&&(re(y),Y(!0)),w.data&&200===(null===(e=w.data)||void 0===e?void 0:e.status)&&(re(h),Y(!0))}),[D,S,w.data,w.error]);var me=function(e){var t=e.show;return 0!==t?(0,v.jsx)(u.b7,{md:2,className:"d-flex align-items-end mb-4",children:(0,v.jsx)(l.Z,{className:1===t?"text-secondary":"text-success",icon:c._,size:"lg"})}):null},xe=function(e){var t=e.categoryOptions,n=e.num,r=t.displayName,a=t.id;return(0,v.jsxs)(u.rb,{children:[(0,v.jsx)(u.b7,{md:3,children:(0,v.jsx)(u.jO,{type:"text",value:r,readOnly:!0,disabled:!0})}),(0,v.jsx)(u.b7,{md:6,children:(0,v.jsxs)(u.YR,{className:"mb-4",children:[(0,v.jsxs)("label",{className:"inputFile",children:[(0,v.jsx)("div",{children:"\u8acb\u9078\u64c7\u6a94\u6848"}),(0,v.jsx)(u.jO,{accept:".xlsx",id:a,type:"file",onChange:function(e){!function(e,t){var n=e.target.files;V[t].fileName=n[0].name,V[t].excelData=n[0],q((0,s.Z)({},V)),ce(n[0],t)}(e,a)},ref:function(e){return E.current[n]=e},style:{display:"none"}})]}),(0,v.jsx)(u.jO,{readOnly:!0,disabled:!0,type:"text",value:V[a].fileName||"\u672a\u9078\u64c7\u4efb\u4f55\u6a94\u6848",ref:function(e){return E.current[n]=e},style:{backgroundColor:"transparent"}}),(0,v.jsx)(u.u5,{type:"button",color:V[a].load?"primary":"secondary",variant:"outline",disabled:!V[a].load,onClick:function(){return function(e,t){var n;if(T[e]=1,L((0,s.Z)({},T)),null!==(n=V[e])&&void 0!==n&&n.excelData){var r=new FormData;r.append("file",V[e].excelData),C.request(r.getAll("file")).then((function(t){if(200===t.status){T[e]=2,L((0,s.Z)({},T));var n=Object.keys(T).every((function(e){return 2===T[e]}));n&&U(!0)}})).catch((function(n){T[e]=0,le(e,t),console.log(n)}))}}(a,n)},children:"\u958b\u59cb\u4e0a\u50b3"})]})}),(0,v.jsx)(me,{show:T[a]})]})};return(0,v.jsxs)("div",{className:"px-3",children:[(0,v.jsxs)(u.KB,{children:[(0,v.jsxs)(u.Gc,{color:"info",dismissible:!0,children:[(0,v.jsx)(u.g$,{component:"h5",children:"MS\u6a9f\u683c\u518a\u6574\u6279\u532f\u5165"}),(0,v.jsx)("p",{className:"m-0",children:"- \u9700\u4e0a\u50b3\u5168\u90e8\u7684\u50f9\u683c\u518a\u624d\u80fd\u6574\u6279\u532f\u5165"}),(0,v.jsx)("p",{className:"m-0",children:"- \u50f9\u683c\u518a\u6a94\u540d\u50c5\u82f1\u6587\uff0c\u4e0d\u53ef\u6709\u4e2d\u6587\u3001\u7a7a\u767d\u53ca\u7b26\u865f"})]}),(0,v.jsx)("h5",{className:"mb-3",children:"\u50f9\u683c\u518a\u8cc7\u8a0a"}),(0,v.jsxs)("div",{className:"form-box",children:[(0,v.jsxs)(u.rb,{className:"align-items-center pb-2",children:[(0,v.jsxs)(u.b7,{sm:4,children:["\u7576\u524d\u50f9\u683c\u518a\u7248\u865f(",F.currentVersionData?F.currentVersionData.statusDisplay:"\u7cfb\u7d71\u5fd9\u788c\u4e2d",")"]}),(0,v.jsx)(u.b7,{sm:2,children:null===F||void 0===F||null===(x=F.currentVersionData)||void 0===x?void 0:x.versionNumber})]}),(0,v.jsxs)(u.rb,{className:"align-items-center",children:[(0,v.jsxs)(u.b7,{sm:4,children:["\u6700\u65b0\u50f9\u683c\u518a\u7248\u672c(",F.latestVersionData?F.latestVersionData.statusDisplay:"\u7cfb\u7d71\u5fd9\u788c\u4e2d",")"]}),(0,v.jsx)(u.b7,{sm:2,children:null===F||void 0===F||null===(j=F.latestVersionData)||void 0===j?void 0:j.versionNumber})]})]}),ie?(0,v.jsx)("div",{className:"d-flex justify-content-center mt-2",children:(0,v.jsx)("p",{children:"\u50f9\u683c\u518a\u532f\u5165DB\u4e2d\uff0c\u8acb\u7a0d\u5f8c\u518d\u4e0a\u50b3\u3002"})}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("h5",{className:"mb-3",children:"\u4e0a\u50b3\u50f9\u683c\u518a"}),(0,v.jsx)("div",{className:"form-box mb-1 pt-4 pb-0",style:{borderRadius:"10px 10px 0 0"},children:d.A.map((function(e,t){return(0,v.jsx)(xe,{categoryOptions:e,num:t},t)}))}),(0,v.jsx)("div",{className:"form-box",style:{borderRadius:"0 0 10px 10px"},children:(0,v.jsx)(u.rb,{md:{cols:12},children:(0,v.jsx)(u.b7,{md:12,children:(0,v.jsx)(u.u5,{onClick:function(){return function(e){return(n=n||(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de(),e.next=3,fe(t).then((function(){pe()}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(d.A)},disabled:!z||_,color:z?"primary":"secondary",type:"button",variant:"outline",children:_||w.loading?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u.LQ,{component:"span",size:"sm","aria-hidden":"true"}),(0,v.jsx)("span",{children:" Loading..."})]}):"\u9001\u51fa\u50f9\u683c\u518a"})})})})]})]}),(0,v.jsx)(m.Z,{isShow:Q,closeModal:function(){return Y(!1)},handleRightBtn:function(){Y(!1)},rightBtnText:"\u6211\u77e5\u9053\u4e86",title:ne.title,infoContain:ne.infoContain})]})}))},79041:function(e,t,n){"use strict";n.d(t,{_:function(){return r}});var r=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M426.072,86.928A238.75,238.75,0,0,0,88.428,424.572,238.75,238.75,0,0,0,426.072,86.928ZM257.25,462.5c-114,0-206.75-92.748-206.75-206.75S143.248,49,257.25,49,464,141.748,464,255.75,371.252,462.5,257.25,462.5Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='221.27 305.808 147.857 232.396 125.23 255.023 221.27 351.063 388.77 183.564 366.142 160.937 221.27 305.808' class='ci-primary'/>"]},24654:function(){}}]);
//# sourceMappingURL=861.4df12205.chunk.js.map