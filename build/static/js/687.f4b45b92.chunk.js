"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[687],{32687:function(e,r,n){n.r(r);var t=n(29439),a=n(72791),o=n(78983),c=n(34045),i=n(80184);r.default=function(){var e={header:[],body:[]},r=a.useState(e),n=(0,t.Z)(r,2),l=n[0],s=n[1],u={data:[],meta:{}},d=a.useRef(),h=function(e){if(e){var r=new FileReader,n=!!r.readAsBinaryString;r.onload=function(e){try{var r=e.target.result,t=c.ij(r,{type:n?"binary":"array"}),a=t.SheetNames[0],o=t.Sheets[a];console.log(n,t);var i=c.P6.sheet_to_json(o,{header:1});console.log(i),f(i),console.log(l)}catch(s){console.error(s)}},n?r.readAsBinaryString(e):r.readAsArrayBuffer(e)}else console.error("file is empty")},f=function(e){if(Array.isArray(e)){var r=e[0],n=e.splice(1);s({header:r,body:n})}},p=function(e){return(0,i.jsx)(i.Fragment,{children:e.map((function(e,r){return(0,i.jsx)(o.NN,{children:e||""},"".concat(e,"_").concat(r))}))})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.rb,{children:(0,i.jsx)(o.b7,{md:4,children:(0,i.jsxs)(o.YR,{className:"mb-3",children:[(0,i.jsx)(o.jO,{type:"file",accept:".xlsx",id:"inputFile",onChange:function(e){var r=e.target.files;console.log(r),h(r[0])},ref:d}),(0,i.jsx)(o.u5,{type:"button",color:"secondary",variant:"outline",children:"\u958b\u59cb\u4e0a\u50b3"}),(0,i.jsx)(o.u5,{type:"button",color:"secondary",variant:"outline",onClick:function(){d.current.value=null,s(e)},children:"\u79fb\u9664"}),(0,i.jsx)(o.u5,{type:"button",color:"secondary",variant:"outline",onClick:function(){for(var e=0;e<l.body.length;e++){var r=l.body[e],n=(0,t.Z)(r,7),a=n[0],o=n[1],c=n[2],i=n[3],s=n[4],d=n[5],h=n[6];u.data.push({partNumber:a,itemName:o,level:c,purchaseUnit:i,purchasePeriod:s,currentNetPrice:d,estimatedRetailPrice:h})}console.log(u),u.data.length},children:"\u532f\u5165"})]})})}),(0,i.jsx)("div",{children:(0,i.jsx)(o.rb,{className:"form-box px-2 overflow-scroll",children:(0,i.jsxs)(o.Sx,{hover:!0,className:"table-bg-none",children:[(0,i.jsx)(o.V,{children:(0,i.jsx)(o.T6,{children:l.header.map((function(e,r){return(0,i.jsx)(o.is,{scope:"col",children:e},"".concat(e,"_").concat(r))}))})}),(0,i.jsx)(o.NR,{children:l.body.map((function(e,r){return(0,i.jsx)(o.T6,{children:p(e)},"body_".concat(r))}))})]})})})]})}}}]);
//# sourceMappingURL=687.f4b45b92.chunk.js.map